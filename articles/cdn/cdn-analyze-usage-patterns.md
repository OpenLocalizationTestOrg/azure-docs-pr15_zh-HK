<properties
    pageTitle="分析 Azure CDN 使用模式 |Microsoft Azure"
    description="您可以使用下列报告您 CDN 查看使用模式︰ 带宽、 数据传输、 点击量、 缓存状态、 缓存命中率、 IPV4/IPV6 数据传输。"
    services="cdn"
    documentationCenter=""
    authors="camsoper"
    manager="erikre"
    editor=""/>

<tags
    ms.service="cdn"
    ms.workload="tbd"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="07/28/2016"
    ms.author="casoper"/>

# <a name="analyze-azure-cdn-usage-patterns"></a>分析 Azure CDN 使用模式

[AZURE.INCLUDE [cdn-verizon-only](../../includes/cdn-verizon-only.md)]

您可以查看您使用以下报表的 CDN 使用模式︰

- 带宽
- 传输数据
- 命中次数
- 高速缓存状态
- 高速缓存命中率
- IPV4/IPV6 数据传输

## <a name="accessing-advanced-http-reports"></a>访问高级的 HTTP 报告

1. 从 CDN 配置文件刀片式服务器，请单击**管理**按钮。

    ![CDN 配置文件刀片式服务器管理按钮](./media/cdn-reports/cdn-manage-btn.png)

    CDN 管理门户打开。

2. 悬停在**分析**选项卡，然后悬停在**核心报告**飞出。  单击菜单中所需的报告。

    ![CDN 管理门户的核心报告菜单](./media/cdn-reports/cdn-core-reports.png)


## <a name="bandwidth"></a>带宽

带宽报告包含在特定时间段内的 HTTP 和 HTTPS 指示带宽使用情况图表和数据表格。 您可以跨所有 CDN Pop 或特定 POP 查看带宽使用率。 这允许您查看整个 CDN 中弹出以 mbps 为单位的流量峰值和分发。

- 选择所有的边缘节点以查看所有节点的通信或从下拉列表中选择一个特定地区/节点。
- 选择要查看今天/本周/本月的数据等，或输入自定义的日期，然后单击"转"，以确保您的选择进行更新的日期范围。
- 您可以导出并通过单击 excel 表图标旁边的"转到"下载数据。

每隔 5 分钟更新报表时。

![带宽报告](./media/cdn-reports/cdn-bandwidth.png)

## <a name="data-transferred"></a>传输数据

此报告包含在特定时间段内的 HTTP 和 HTTPS 指示带宽使用率图表和数据表格。 您可以跨所有 CDN Pop 或特定 POP 查看带宽使用率。 这允许您查看整个 CDN 中弹出以 gb 为单位的流量峰值和分发。

- 选择所有的边缘节点以查看所有便笺的通信或从下拉列表中选择一个特定地区/节点。
- 选择要查看今天/本周/本月的数据等，或输入自定义的日期，然后单击"转"，以确保您的选择进行更新的日期范围。
- 您可以导出并通过单击 excel 表图标旁边的"转到"下载数据。

每隔 5 分钟更新报表时。

![传输数据的报告](./media/cdn-reports/cdn-data-transferred.png)

## <a name="hits-status-codes"></a>点击 （状态代码）

本报告描述请求状态代码为您的内容的分发。 对内容的每个请求将生成 HTTP 状态代码。 状态代码描述边缘 Pop 如何处理该请求。 例如，2xx 状态代码表示，请求已成功地提供给客户端，4xx 状态代码指示错误发生时。 有关 HTTP 状态代码的详细信息，请参阅[状态代码](https://en.wikipedia.org/wiki/List_of_HTTP_status_codes)。

- 选择要查看今天/本周/本月的数据等，或输入自定义的日期，然后单击"转"，以确保您的选择进行更新的日期范围。
- 您可以导出并通过单击"转"旁边的 excel 工作表中下载数据。

![点击报表](./media/cdn-reports/cdn-hits.png)

## <a name="cache-statuses"></a>高速缓存状态

此报告描述了高速缓存命中次数和高速缓存未命中的客户端请求的分发。 以来最快的性能来自于高速缓存命中次数，您可以优化数据传递速度，通过最小化缓存未命中和过期的缓存命中。 配置源服务器以避免分配"无缓存"响应标头、 避免在严格需要时，查询字符串缓存除和避免不可缓存的响应代码，可以减小缓存未命中数。 过期的缓存命中可以避免某项资产，从而尽量减少对原始服务器的请求数尽可能长时间的最大期限。

![高速缓存状态报表](./media/cdn-reports/cdn-cache-statuses.png)

### <a name="main-cache-statuses-include"></a>主高速缓存状态包括︰

- TCP_HIT︰ 提供服务的边缘。 对象在缓存中，必须不超过其最大期限。
- TCP_MISS︰ 提供服务的来源。 对象不在缓存中，是和响应的回原点。
- TCP_EXPIRED _MISS︰ 来源与重新验证之后提供服务的来源。 该对象已在缓存中，但已经超出了它的最大年龄。 原点重新验证会导致被替换为新的响应从原点的缓存对象。
- TCP_EXPIRED _HIT︰ 与原点重新验证之后提供服务的边缘。 该对象已在缓存中，但已经超出了它的最大年龄。 源服务器重新验证会导致被修改的缓存对象。

- 选择要查看今天/本周/本月的数据等，或输入自定义的日期，然后单击"转"，以确保您的选择进行更新的日期范围。
- 您可以导出并通过单击 excel 表图标旁边的"转到"下载数据。

### <a name="full-list-of-cache-statuses"></a>高速缓存状态的完整列表

- TCP_HIT-此状态报告请求直接从 POP 提供给客户端时。 从 POP 时缓存在客户端与最接近的弹出窗口和它有一个有效的生存时间或 TTL 立即提供一项资产。 TTL 取决于以下响应标头︰

    - 高速缓存控制︰ s maxage
    - 高速缓存控制︰ 最大期限
    - 过期

- TCP_MISS-此状态指示，POP 最接近客户端上未找到请求的资源的缓存的版本。 将从原始服务器或源罩服务器请求资产。 如果源服务器或源罩服务器返回某项资产，它将提供给客户端并在客户端和边缘服务器缓存。 否则为非 200 状态代码 (例如，403 禁止访问，404 找不到，等) 将返回。

- TCP_EXPIRED _HIT-此状态报告时目标使用到期 TTL，如资产的最大期限已过期时，资产的请求直接从 POP 提供给客户端。

    过期的请求通常会导致重新验证请求到源服务器。 为了使 TCP_EXPIRED _HIT 发生，源服务器必须指明资产的较新版本不存在。 这种情况通常会更新该资产的缓存控制和过期标头。

- TCP_EXPIRED _MISS-此状态报告时过期缓存资产的较新版本从 POP 提供给客户端。 出现这种情况是当过期缓存资产的 TTL （如过期最大期限） 和原始服务器返回该资产的较新版本。 这个新版本的资产提供给客户端，而不是缓存的版本。 此外，它将边缘服务器和客户端缓存。

- CONFIG_NOCACHE-此状态指示，我们边 POP 客户特定的配置禁止资产被缓存。

- 无-此状态指示高速缓存内容新鲜度检查未执行。

- TCP_ CLIENT_REFRESH _MISS-HTTP 客户端 （例如，浏览器） 强制边缘 POP 从原始服务器中检索陈旧资产的新版本时，将报告此状态。

    默认情况下，我们的服务器阻止非 HTTP 客户端强制我们的边缘服务器从源服务器中检索新的资产版本。

- TCP_ PARTIAL_HIT-字节范围请求导致局部缓存资产命中时报告此状态。 立即处理请求的字节范围从 POP 客户端。

- 无缓存的资产缓存控制和过期标头指示它应该不被缓存在 POP 或 HTTP 客户端时，将报告该状态。 这些类型的请求将由源服务器

## <a name="cache-hit-ratio"></a>高速缓存命中率

此报表指明了直接从缓存中提供的缓存请求的百分比。

该报告提供了以下详细信息︰

- 所请求的内容被缓存在靠近申请者的弹出窗口。
- 该请求被提供直接从我们的网络的边缘。
- 请求不需要与源服务器重新验证。

报告不包括︰

- 由于国家筛选选项而拒绝的请求。
- 其标头指示它们应不被缓存的资源请求。 例如，缓存控制︰ 专用缓存控制︰ 无缓存或杂注︰ 无缓存标头将阻止资产被缓存。
- 字节范围请求部分缓存内容。

计算公式: (TCP_ 命中 / (TCP_ 点击 + TCP_MISS)) * 100

- 选择要查看今天/本周/本月的数据等，或输入自定义的日期，然后单击"转"，以确保您的选择进行更新的日期范围。
- 您可以导出并通过单击 excel 表图标旁边的"转到"下载数据。


![缓存访问的率报告](./media/cdn-reports/cdn-cache-hit-ratio.png)

## <a name="ipv4ipv6-data-transferred"></a>IPV4/IPV6 数据传输

此报告显示在 IPV4 和 IPV6 通信的使用分布情况。

![IPV4/IPV6 数据传输](./media/cdn-reports/cdn-ipv4-ipv6.png)

- 选择要查看等今天/本周/本月的数据或输入自定义日期的日期范围。
- 然后，单击"向"以确保您的选择进行更新。


## <a name="considerations"></a>注意事项

仅在过去的 18 个月内生成的报告。
