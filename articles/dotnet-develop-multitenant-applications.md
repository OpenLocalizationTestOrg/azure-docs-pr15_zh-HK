<properties
    pageTitle="Web 的多租户应用程序模式 |Microsoft Azure"
    description="到体系结构的概述，并描述如何在 Azure 上实现 web 的多租户应用程序的设计模式。"
    services=""
    documentationCenter=".net"
    authors="wadepickett" 
    manager="wpickett"
    editor=""/>

<tags
    ms.service="active-directory"
    ms.workload="identity"
    ms.tgt_pltfrm="na"
    ms.devlang="dotnet"
    ms.topic="article"
    ms.date="06/05/2015"
    ms.author="wpickett"/>

# <a name="multitenant-applications-in-azure"></a>在 Azure 中的多租户应用程序

多租户应用程序是允许单独的用户或"承租人"以查看该应用程序就像是自己的共享的资源。 通常情况下，适合于多租户应用程序是应用程序的所有用户可能都想要自定义的用户体验，但具有相同的基本业务需求。 大型的多租户应用程序的示例包括 Office 365、 Outlook.com 和 visualstudio.com。

从应用程序提供商的角度来看，多租赁的好处大多与运营和成本效率。 您的应用程序的一个版本可以满足很多承租人/客户，从而整合的系统管理任务，如监视、 性能优化、 软件维护和数据备份的需求。

下面列出了最重要的目标和要求，从提供者的角度来看。

- **资源调配**︰ 您必须能够提供应用程序的新租户。  多租户应用程序的大量租户，则通常需要启用自助设置自动执行此过程。
- **可维护性**︰ 您必须能够升级应用程序和多个租户在使用它时执行其他维护任务。
- **监视**︰ 您必须能够监视应用程序在所有时间来识别任何问题并解决这些问题。 这包括监视每个租户使用应用程序的方式。

正确实现的多租户应用程序为用户提供了以下好处。

- **隔离**︰ 个别租户的活动不会影响其他租户的应用程序的使用。 租户不能访问彼此的数据。 似乎给租户，就好像他们拥有的应用程序独占使用。
- **可用性**︰ 个别租户希望应用程序可用的持续，可能在 SLA 中定义的保证。 同样，其他承租人的活动应不会影响应用程序的可用性。
- **可伸缩性**︰ 应用程序可以进行扩展以满足个别租户的需求。 出席，其他承租人的操作应该不会影响应用程序的性能。
- **成本**︰ 成本是低于专用的、 单租户应用程序在运行，因为多组织实现资源的共享。
- **可自定义性**。 自定义个别租户以各种方式，例如添加或删除功能，更改颜色和徽标，或甚至添加自己的代码或脚本的应用程序的能力。

简单地说，虽然有许多因素必须考虑到要提供一个高度可扩展的服务，也有大量的目标和要求所共有的许多多租户应用程序。 一些可能不会在特定情况下，相关，各个目标和要求的重要性在每种情况下会有所不同。 作为多租户应用程序的提供程序，您还将目标和要求，如，满足承租人的目标和要求、 盈利能力、 计费、 多个服务级别、 资源调配、 可维护性监控和自动化。

多租户应用程序的其它设计注意事项的详细信息，请参阅[承载在 Azure 上多租户应用程序][]。 多租户软件作为服务 (SaaS) 数据库应用程序的常见数据体系结构模式的信息，请参阅[SQL Azure 数据库的多租户 SaaS 应用程序的设计模式](./sql-database/sql-database-design-patterns-multi-tenancy-saas-applications.md)。 

Azure 提供许多功能，可用于解决在设计多租户系统时遇到的关键问题。

**隔离**

- 通过带有或不带 SSL 通信的主机标头网站段承租人
- 细分网站承租人通过查询参数
- 辅助角色中的 web 服务
    - 辅助角色。 通常处理数据的应用程序的后端。
    - 通常用作应用程序的前端的 web 角色。

**存储**

例如，SQL Azure 数据库或 Azure 存储服务如表服务，它提供了大量非结构化数据的存储服务和提供服务来存储大量的非结构化文本的 Blob 服务或二进制数据，如视频、 音频和图像数据管理。

- 固定的 Multitenant 数据相应的 SQL 数据库中每个租户的 SQL Server 登录名。
- 应用程序资源通过指定容器级别的访问权限策略的使用 Azure 表，可以调整权限，而无需发出新的 URL 的共享的访问签名与受保护的资源的能力。
- Azure 应用程序资源 Azure 的队列的队列通常习惯于驱动器处理代表承租人，但也可用于分配所需的资源调配或管理的工作。
- 服务总线队列应用程序资源推动的工作方式与共享服务，您可以使用单个队列，每个租户发件人时才有权限 （根据索赔颁发的 ACS） 将推送到该队列，而仅从服务接收方有权从队列中提取的数据来自多个租户。


**连接和安全服务**

- Azure 服务总线，使他们的应用程序来改进刻度的松耦合的方式交换消息和可恢复性之间一个消息处理结构。

**网络服务**

Azure 提供支持的身份验证，并提高您的宿主应用程序的可管理性的多个网络服务。 这些服务包括︰

- Azure 虚拟网络允许您设置和管理 Azure 中的虚拟专用网络 (Vpn) 以及安全地将这些链接内部部署的 IT 基础结构。
- 虚拟的网络流量管理器允许您通信执行负载平衡传入跨多个承载的 Azure 服务是否它们正在运行在同一个数据中心或在世界各地的不同数据中心。
- Azure 活动目录 (AD Azure) 是一种现代的、 基于 REST 的服务为云应用程序提供身份管理和访问控制功能。 为应用程序资源到 Azure 广告提供了一种简单方法进行身份验证和授权用户访问您的 web 应用程序和服务同时允许的身份验证和授权，以分解出来您的代码的功能使用 Azure 的广告。
- Azure 服务总线提供安全消息发送和分布式数据的流动能力，混合应用程序，例如 Azure 之间的通讯承载的应用程序和内部部署的应用程序和服务，而无需复杂的防火墙和安全基础设施。 作为终结点公开的服务的应用程序资源使用服务总线中继可能属于组织 （例如，承载外部系统的内部部署版本），或者他们可能 （因为它们之间传输敏感的、 特定于租户的数据），专门为租户提供服务。



**调配资源**

Azure 应用程序提供了多种方式供应新的租户。 多租户应用程序的大量租户，则通常需要启用自助设置自动执行此过程。

- 辅助角色允许您提供和消除每个租户提供资源 （例如，当新租户迹象向上或取消），收集指标的测定使用和管理按照一定的计划的规模或响应阈值的关键绩效指标的交叉。 此外可能使用相同的角色以将推出更新和升级到解决方案中。
- 可以用来设置计算或预初始化 azure Blob 存储资源，同时提供容器级别的访问权限策略的新租户保护计算服务包，VHD 映像和其他资源。
- 为租户提供 SQL 数据库资源的选项包括︰

    -   DDL 脚本中的或作为资源在程序集中嵌入
    -   SQL Server 2008 R2 DAC 包以编程方式部署。
    -   从主引用数据库复制
    -   使用数据库导入和导出配置文件中的新数据库。



<!--links-->

[在 Azure 上的是多租户应用程序承载]: http://msdn.microsoft.com/library/hh534480.aspx
[Designing Multitenant Applications on Azure]: http://msdn.microsoft.com/library/windowsazure/hh689716
